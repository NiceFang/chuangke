<!DOCTYPE html>
<html lang="zh-CN">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>{$title}</title>

<!-- 旧的样式 -->
<!-- <link rel="stylesheet" href="__WCSS__/style.css">
<link rel="stylesheet" href="__WCSS__/meCen.css"> -->

<!-- 新的的样式 -->
<link rel="stylesheet" href="__WCSS__/base.css">
<link rel="stylesheet" href="__WCSS__/Setuname.css">
<link rel="stylesheet" href="__WCSS__/mui.min.css">
<link rel="stylesheet" href="__WCSS__/accountManage.css">

<script src="__WJS__/jquery1.11.1.min.js"></script>
<script type="text/javascript" src="__COM__/layer/layer.js"></script>
<script type="text/javascript" src="__COM__/js/index.js"></script>
<!-- 获取头部的颜色 -->
<script type="text/javascript" src="__WJS__/color.js"></script>
<script src="__WJS__/mui.min.js"></script>
<script src="__WJS__/rem.js"></script>

<style>
	.input_code input {
		width: 3.7917rem;
		margin: 0;
		line-height: 0.875rem;
		height: 0.875rem;
		border-radius: 0;
		border-top-left-radius: 0.4375rem;
		border-bottom-left-radius: 0.4375rem;
	}

	.input_code a,
	.input_code>img {
		height: 0.875rem;
		width: 2.0833rem;
		/* background: RGBA(255, 255, 255,0.4); */
		color: #fff;
		line-height: 0.84rem;
		border-top-right-radius: 0.4375rem;
		border-bottom-right-radius: 0.4375rem;
		font-size: 0.3333rem;
		background-color: #7AC231;
	}

	.input_box .phone-code {
		display: -webkit-box;
		display: -ms-flexbox;
		display: flex;
		-webkit-box-align: center;
		-ms-flex-align: center;
		align-items: center;
	}

	.input_box .phone-code input {
		width: 50%;
		height: .72rem;
		border-radius: 0;
		border-top-left-radius: .4rem;
		border-bottom-left-radius: .4rem;
	}

	.input_box .phone-code a {
		width: 50%;
		height: .72rem;
		display: block;
		color: #1188ff;
		margin-top: .2rem;
		padding: .2rem 0;
		background: #d9bc59;
		font-size: .28rem;
		border-top-right-radius: .4rem;
		border-bottom-right-radius: .4rem;
	}
	.noteBox {
		display: flex;
		align-items: center;
		box-sizing: border-box;
		padding: 0rem 0.3333rem;
	}
	.noteBox .noteIcon {
		height: 0.5208rem;
	}
	#code {
		font-size: 0.2917rem;
		color: #ccc;
	}
	#mycode {
		width: 1.6667rem;
		border-radius: 0.4167rem;
		height: 0.5208rem;
		font-size: 0.2917rem;
		line-height: 0.5208rem;
		text-align: center;
	}

</style>

<body class="bg96 ">
	<!-- 旧的代码 -->
	<!-- <div class="header">
	    <div class="header_l">
	    <a href="javascript:history.go(-1)"><img src="__WIMG__/jiant.png" alt=""></a>
	    </div>
		<eq name="type" value="1">
			<div class="header_c"><h2>{$Think.lang.uplogpwd}</h2></div>
		<else/>
			<div class="header_c"><h2>{$Think.lang.paypwdup}</h2></div>
		</eq>

	    <div class="header_r"></div>
	</div>

     <div class="big_width100">
        <div class="add_bank_add_gr">
	       <div class="fill_sty add_gr_b10">
	       	<p>{$Think.lang.oldpwd}</p>
	       	<input type="password" name="password" class="password" placeholder="{$Think.lang.srjmm}"   />
	       </div>
	       <div class="fill_sty add_gr_b10 mababno">
	       	<p>{$Think.lang.newpwd}</p>
	       	<input type="password" name="password" class="passwordrepat" placeholder="{$Think.lang.srxmm}"   />
			   <input type="hidden" value="{$type}" class="pwdtype">
	       </div>
	     </div>

	        <div class="wangjmim_se">
				<eq name="type" value="1">
					<a href="{:U('login/getpsw')}">{$Think.lang.forgelogpwd}</a>
					<else />
					<a href="{:U('login/getpswpay')}">{$Think.lang.wjzfmm}</a>
				</eq>
	        </div>

	       <div class="buttonGeoup">
	       		<a href="javascript:void(0)" class="not_next ljzf_but ">{$Think.lang.termine}</a>
	       </div>
	</div> -->

	<!-- 新的代码 -->
	 <!-- 头部 -->
	 <div class="hear">
		<a href="{:U('User/Personal')}"><img src="__WIMG__/user/user_jiantouzuo.png" alt=""></a>
		 <eq name="type" value="1">
			 {$Think.lang.uplogpwd}</div>
			 <else/>
			 {$Think.lang.paypwdup}</div>
		 </eq>
	</div>
	
	
		<!-- 密码 -->
		<div class="user_info">
			<form class="mui-input-group">
				<div class="mui-input-row user_info_lis">
					<label class="name pwd">{$Think.lang.oldpwd}</label>
					<input type="number" class=" pwd_input password" placeholder="" id="demo_input">
					<img src="__WIMG__/user/keshi.png" alt="" id="demo_img" onclick="hideShowPsw('demo_img','demo_input')">
				</div>
				<div class="mui-input-row user_info_lis">
					<label class="name pwd">{$Think.lang.newpwd}</label>
					<input type="password" class="pwd_input passwordrepat" placeholder="" id="new_input">
					<img src="__WIMG__/user/mima.png" alt="" id="new_img" onclick="hideShowPsw('new_img','new_input')">
				</div>

				<!--短信验证码-->
				<div class="input_box input_code noteBox">
					<span><img class="noteIcon" src="__WIMG__/moblie_code.png" alt=""></span>
					<input style="flex: 1;" type="number" id="code" name="code" class="code" placeholder="{$Think.lang.qsrshoujyzm}"
						   oncontextmenu="return false" onpaste="return false" />
					<a href="javascript:void(0)" id="mycode">{$Think.lang.hq}</a>
				</div>

				<input type="hidden" value="{$type}" class="pwdtype">
				<input type="hidden" value="{$mobile}" id="mobile" class="pwdtype">

			</form>
		</div>
	
		<!-- 忘记mima -->
		<div class="busy fr">
			<a href="{:U('login/getpsw')}">
				<eq name="type" value="1">
					<a href="{:U('login/getpsw')}">{$Think.lang.forgelogpwd}</a>
					<else />
					<a href="{:U('login/getpswpay')}">{$Think.lang.wjzfmm}</a>
				</eq>
			</a>
		</div>
	
		<!-- 保存按钮 -->
		<div class=" name pwd_save ljzf_but" id="confirm">{$Think.lang.termine}</div>
	</body>


	<!--错误提示-->
	<input type="hidden" id="jmmbnwk" value="{$Think.lang.jmmbnwk}">
	<input type="hidden" id="xmmbnwk" value="{$Think.lang.xmmbnwk}">
	<input type="hidden" id="jymmznw6w" value="{$Think.lang.jymmznw6w}">
	<input type="hidden" id="dxyzmbnwk" value="{$Think.lang.dxyzmbnwk}">
</body>

</html>


<script type="text/javascript">
	// input 的值不为空添加按钮样式
	$("form input").blur(function () {
		if (($("input[type=password]").val() != "")) {
			$(".pwd_save").addClass("active");
		}
	})

	// 点击切换密码可视状态
	function hideShowPsw(img,input) {
		var getImg = document.getElementById(img);
		var getInput = document.getElementById(input);
		if (getInput.type == "password") {
			getInput.type = "number";
			getImg.src = "__WIMG__/user/keshi.png";
		} else {
			getInput.type = "password";
			getImg.src = "__WIMG__/user/mima.png";
		}
	}

</script>
<script>
	$('.ljzf_but').click(function () {
		var jmmbnwk = $('#jmmbnwk').val();
		var xmmbnwk = $('#xmmbnwk').val();
		var jymmznw6w = $('#jymmznw6w').val();
		var dxyzmbnwk =  $('#dxyzmbnwk').val();

		var pwd = $('.password').val();
		var pwdrpt = $('.passwordrepat').val(); //新密码
		var pwdtype = $('.pwdtype').val();
		var code = $('#code').val();

		if (pwd == '') {
			msg_alert(jmmbnwk);
		}
		if (pwdrpt == '') {
			msg_alert(xmmbnwk);
			return;
		}
        if (code == '') {
            msg_alert(dxyzmbnwk);
            return;
        }
		if (pwdtype == 2) {
			//交易密码必须为6位纯数字
			var reg = /^\d{6}\b/;
			if (!reg.test(pwdrpt)) {
				msg_alert(jymmznw6w);
				return false;
			}
		}
		$.ajax({
			url: '/User/Setpwd',
			type: 'post',
			data: {
				'pwd': pwd,
				'pwdrpt': pwdrpt,
				'pwdtype': pwdtype,
				'code':code
			},
			datatype: 'json',
			success: function (mes) {
				if (mes.status == 1) {
					msg_alert(mes.message, mes.url);
				} else {
					msg_alert(mes.message);
				}
			}
		})
	})
</script>
<script>

    var intime = "{$Think.session.set_time}";
    var timenow = "<?php echo time(); ?>";

    var bet = (parseInt(intime) + 60) - parseInt(timenow);
    $(document).ready(function () {
        if (bet > 0) {
            RemainTime();
        }
    });
    var iTime = 50;
    var Account;
    if (bet > 0) {
        iTime = bet;
    }
    // 封装的计时器
    function RemainTime() {
        var iSecond, sSecond = "",
            sTime = "";
        if (iTime >= 0) {
            iSecond = parseInt(iTime % 60);
            iMinute = parseInt(iTime / 60)
            if (iSecond >= 0) {
                if (iMinute > 0) {
                    sSecond = iMinute + "m" + iSecond + "s";
                } else {
                    sSecond = iSecond + "s";
                }
            }
            sTime = sSecond;
            if (iTime == 0) {
                var hqyzm = $('#hqyzm').val() //获取验证码
                clearTimeout(Account);
                sTime = hqyzm;
                iTime = 59;
            } else {
                Account = setTimeout("RemainTime()", 1000);
                iTime = iTime - 1;
            }
        } else {
            sTime = '没有倒计时';
        }
        $('#mycode').html(sTime);
    }

    // 手机验证码
    $('#mycode').click(function () {

        //$("#confirm").css('backgroundColor', "rgba(255,255,255,0.5)");
        var mobile = $("#mobile").val();

        var jmmbnwk = $('#jmmbnwk').val(); // 旧密码
        var xmmbnwk = $('#xmmbnwk').val(); // 新密码

        if (mobile == '' || mobile == null) {
            layer.msg(qsrsjhm);
            return false;
        }
        if($('#demo_input').val() == null || $('#demo_input').val() == ''){
            layer.msg(jmmbnwk);
            return false;
		}
        if($('#new_input').val() == null || $('#new_input').val() == ''){
            layer.msg(xmmbnwk);
            return false;
        }
		a =0;
        if (a == 1) {
            layer.msg(txyzmcw);
        } else {
            $.post("{:U('Login/sendPwdCode')}", {
                'mobile': mobile,
                'l': "{:I('get.l')}"
            }, function (data) {
                // alert('ajax发送成功');
                if (data.status == 1) {
                    // alert('发送成功');
                    layer.msg(data.message);
                    RemainTime();
                } else {
                    // alert('发送失败！');
                    layer.msg(data.message);
                }
            });
        }

    });
</script>